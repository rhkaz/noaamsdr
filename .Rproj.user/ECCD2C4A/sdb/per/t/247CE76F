{
    "collab_server" : "",
    "contents" : "\nNOAACoursera\n============\n\n[![Build Status](https://travis-ci.org/JhossePaul/NOAACoursera.svg?branch=master)](https://travis-ci.org/JhossePaul/NOAACoursera)\n\n[Building details](https://travis-ci.org/JhossePaul/NOAACoursera)\n\nThe goal of NOAACoursera is to create a package to manipulate and analyze the eartquakes [NOAA dataset](NOAA). This project corresponds to the capstone project of the \"Mastering Software Development in R\" Coursera's specialization.\n\nInstallation\n------------\n\nThis is a basic example which shows you how to solve a common problem:\n\n``` r\ndevtools::install_github(\"JhossePaul/NOAACoursera\")\n```\n\nUsage\n-----\n\nThe package currently contains functions to:\n\n-   Get the dataset\n-   Clean the variables\n-   Visualize a timeline of the earthquakes\n-   Visualize a map with the epicenters\n\n### Get data\n\nThis package will download and put the data in a persistent directory unless you specify another path. Just write\n\n``` r\nlibrary(tidyverse)\n#> Loading tidyverse: ggplot2\n#> Loading tidyverse: tibble\n#> Loading tidyverse: tidyr\n#> Loading tidyverse: readr\n#> Loading tidyverse: purrr\n#> Loading tidyverse: dplyr\n#> Conflicts with tidy packages ----------------------------------------------\n#> filter(): dplyr, stats\n#> lag():    dplyr, stats\nlibrary(lubridate)\n#> \n#> Attaching package: 'lubridate'\n#> The following object is masked from 'package:base':\n#> \n#>     date\nlibrary(NOAACoursera)\neq_get_data() %>% glimpse\n#> Observations: 5,934\n#> Variables: 47\n#> $ I_D                                <chr> \"1\", \"3\", \"2\", \"5877\", \"8\",...\n#> $ FLAG_TSUNAMI                       <chr> NA, NA, \"Tsu\", \"Tsu\", NA, N...\n#> $ YEAR                               <chr> \"-2150\", \"-2000\", \"-2000\", ...\n#> $ MONTH                              <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ DAY                                <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ HOUR                               <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ MINUTE                             <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ SECOND                             <chr> \"    \", NA, NA, NA, \"    \",...\n#> $ FOCAL_DEPTH                        <chr> NA, \"18\", NA, NA, NA, NA, N...\n#> $ EQ_PRIMARY                         <chr> \" 7.3\", \" 7.1\", NA, NA, NA,...\n#> $ EQ_MAG_MW                          <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ EQ_MAG_MS                          <chr> NA, \" 7.1\", NA, NA, NA, NA,...\n#> $ EQ_MAG_MB                          <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ EQ_MAG_ML                          <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ EQ_MAG_MFA                         <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ EQ_MAG_UNK                         <chr> \" 7.3\", NA, NA, NA, NA, NA,...\n#> $ INTENSITY                          <chr> NA, \"10\", \"10\", NA, \"10\", \"...\n#> $ COUNTRY                            <chr> \"JORDAN\", \"TURKMENISTAN\", \"...\n#> $ STATE                              <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ LOCATION_NAME                      <chr> \"JORDAN:  BAB-A-DARAA,AL-KA...\n#> $ LATITUDE                           <chr> \"  31.100\", \"  38.000\", \"  ...\n#> $ LONGITUDE                          <chr> \"   35.500\", \"   58.200\", \"...\n#> $ REGION_CODE                        <chr> \"140\", \"40\", \"130\", \"130\", ...\n#> $ DEATHS                             <chr> NA, \"       1\", NA, NA, NA,...\n#> $ DEATHS_DESCRIPTION                 <chr> NA, \"1\", \"3\", NA, NA, NA, N...\n#> $ MISSING                            <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ MISSING_DESCRIPTION                <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ INJURIES                           <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ INJURIES_DESCRIPTION               <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ DAMAGE_MILLIONS_DOLLARS            <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ DAMAGE_DESCRIPTION                 <chr> \"3\", \"1\", NA, NA, \"3\", NA, ...\n#> $ HOUSES_DESTROYED                   <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ HOUSES_DESTROYED_DESCRIPTION       <chr> NA, \"1\", NA, NA, NA, NA, NA...\n#> $ HOUSES_DAMAGED                     <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ HOUSES_DAMAGED_DESCRIPTION         <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_DEATHS                       <chr> NA, \"       1\", NA, NA, NA,...\n#> $ TOTAL_DEATHS_DESCRIPTION           <chr> NA, \"1\", \"3\", \"3\", NA, NA, ...\n#> $ TOTAL_MISSING                      <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_MISSING_DESCRIPTION          <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_INJURIES                     <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_INJURIES_DESCRIPTION         <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_DAMAGE_MILLIONS_DOLLARS      <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_DAMAGE_DESCRIPTION           <chr> NA, \"1\", NA, \"3\", NA, NA, \"...\n#> $ TOTAL_HOUSES_DESTROYED             <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_HOUSES_DESTROYED_DESCRIPTION <chr> NA, \"1\", NA, NA, NA, NA, NA...\n#> $ TOTAL_HOUSES_DAMAGED               <chr> NA, NA, NA, NA, NA, NA, NA,...\n#> $ TOTAL_HOUSES_DAMAGED_DESCRIPTION   <chr> NA, NA, NA, NA, NA, NA, NA,...\n```\n\nand you will have the complete raw NOAA dataset in a data.frame object.\n\n### Clean data\n\nBy default, all variables are imported as character. This is because we want to make a more robust cleaning of the data. Again, just pass the dataframe to the cleaning data and you will have a clean dataset with the types of each variable corrected and some new variables that compact information (e.g. date column).\n\n``` r\neq_get_data() %>% eq_clean_data %>% head\n#> # A tibble: 6 Ã— 45\n#>     I_D FLAG_TSUNAMI       DATE  HOUR MINUTE SECOND FOCAL_DEPTH EQ_PRIMARY\n#>   <dbl>        <chr>     <date> <dbl>  <dbl>  <dbl>       <dbl>      <dbl>\n#> 1    38         <NA> 0010-01-01    NA     NA     NA          18        7.1\n#> 2    39         <NA> 0011-01-01    NA     NA     NA          NA         NA\n#> 3    40         <NA> 0017-01-01    NA     NA     NA          NA         NA\n#> 4    41         <NA> 0023-01-01    NA     NA     NA          NA         NA\n#> 5    42         <NA> 0025-01-01    NA     NA     NA          NA         NA\n#> 6    43         <NA> 0027-01-01    NA     NA     NA          NA        6.3\n#> # ... with 37 more variables: EQ_MAG_MW <dbl>, EQ_MAG_MS <dbl>,\n#> #   EQ_MAG_MB <dbl>, EQ_MAG_ML <dbl>, EQ_MAG_MFA <dbl>, EQ_MAG_UNK <dbl>,\n#> #   INTENSITY <dbl>, COUNTRY <chr>, STATE <chr>, LOCATION_NAME <chr>,\n#> #   LATITUDE <dbl>, LONGITUDE <dbl>, REGION_CODE <dbl>, DEATHS <dbl>,\n#> #   DEATHS_DESCRIPTION <dbl>, MISSING <dbl>, MISSING_DESCRIPTION <dbl>,\n#> #   INJURIES <dbl>, INJURIES_DESCRIPTION <dbl>,\n#> #   DAMAGE_MILLIONS_DOLLARS <dbl>, DAMAGE_DESCRIPTION <dbl>,\n#> #   HOUSES_DESTROYED <dbl>, HOUSES_DESTROYED_DESCRIPTION <dbl>,\n#> #   HOUSES_DAMAGED <dbl>, HOUSES_DAMAGED_DESCRIPTION <dbl>,\n#> #   TOTAL_DEATHS <dbl>, TOTAL_DEATHS_DESCRIPTION <dbl>,\n#> #   TOTAL_MISSING <dbl>, TOTAL_MISSING_DESCRIPTION <dbl>,\n#> #   TOTAL_INJURIES <dbl>, TOTAL_INJURIES_DESCRIPTION <dbl>,\n#> #   TOTAL_DAMAGE_MILLIONS_DOLLARS <dbl>, TOTAL_DAMAGE_DESCRIPTION <dbl>,\n#> #   TOTAL_HOUSES_DESTROYED <dbl>,\n#> #   TOTAL_HOUSES_DESTROYED_DESCRIPTION <dbl>, TOTAL_HOUSES_DAMAGED <dbl>,\n#> #   TOTAL_HOUSES_DAMAGED_DESCRIPTION <dbl>\n```\n\n### Visualize a timeline of the dataset\n\nIt could be useful to visualize the earthquakes across time and other variables This is implemented in a couple of ggplot2's geoms:\n\n``` r\ndf <- eq_get_data() %>%\n  eq_clean_data %>%\n  filter(!is.na(EQ_PRIMARY)) %>%\n  filter(year(DATE) > 2000) %>%\n  filter(COUNTRY %in% c(\"CHINA\", \"USA\"))\nggplot(df) +\n  aes(\n    x = DATE,\n    y = COUNTRY,\n    size = EQ_PRIMARY,\n    colour = DEATHS,\n    label = LOCATION_NAME,\n    by = EQ_PRIMARY\n  ) +\n  geom_timeline() +\n  geom_timeline_label(n_max = 5) +\n  theme_timeline\n```\n\n![](README-unnamed-chunk-5-1.png)\n\n### Visualize the earthquakes in a map\n\nA leaflet wrapper is implemented to easily visualize the epicenters:\n\n``` r\neq_get_data() %>%\n  eq_clean_data %>%\n  filter(COUNTRY == \"MEXICO\", year(DATE) >= 2000) %>%\n  eq_map(annot_col = \"DATE\")\n\neq_get_data() %>%\n  eq_clean_data %>%\n  filter(COUNTRY == \"MEXICO\", year(DATE) >= 2000) %>%\n  mutate(popup_text = eq_create_label(.)) %>%\n  eq_map(annot_col = \"popup_text\")\n```\n\nReferences\n----------\n\n-   National Geophysical Data Center / World Data Service (NGDC/WDS): Significant Earthquake Database. National Geophysical Data Center, NOAA. <doi:10.7289/V5TD9V7K>\n",
    "created" : 1494080022610.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3357520985",
    "id" : "247CE76F",
    "lastKnownWriteTime" : 1493052636,
    "last_content_update" : 1493052636,
    "path" : "~/Desktop/noaamsdr/README.md",
    "project_path" : "README.md",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "markdown"
}