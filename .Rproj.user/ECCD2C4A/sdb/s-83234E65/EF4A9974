{
    "collab_server" : "",
    "contents" : "---\ntitle: \"noaamsdr: Capstone project for Coursera\"\nauthor: \"Rashid Kazmi\"\ndate: \"`r Sys.Date()`\"\noutput: rmarkdown::html_vignette\nvignette: >\n  %\\VignetteIndexEntry{Vignette Title}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\n\nThis is the final project of the Coursera's \"Master Software Development in R\"\nspecialization. The objective of this package is provide wrapper functions to\nquickly analyse and visualize the National Oceanic and Atmospheric Administration\ndataset of significant earthquakes.\n\nCurrently the package have the following capabilities:\n\n- Get the NOAA earthquakes dataset\n- Clean the data\n- Visualize the earthquakes timeline\n- Visualize the earthquakes in a map\n\n__NOTE:__ This package heavily relies on the Hadley Wickham's [tidyverse](tidyverse).\n\n### Get data\nThis package will download and put the data in a persistent directory unless you\nspecify another path. Just write \n\n```{r}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(noaamsdr)\n\neq_get_data() %>% glimpse\n```\n\nand you will have the complete raw NOAA dataset in a data.frame object with all\nvariables imported as character. The type handling is done in the cleaning process.\nThis function depends on a the low level functions `eq_download_data` and `eq_file_path`.\nThe `eq_download_data` download the NOAA earthquakes dataset in the specified\ndirectory. The `eq_file_path` returns a valid absolute path to the dataset, if\nthe file to not exist in the passed directory, it downloads it. If the destdir is\nnot specified, a persistent directory will be created. This is the default and\nprefered behaviur. The persistent directory is OS dependent. If you want to update\nthe dataset pass the update = TRUE param.\n\n### Clean data\nBy default, all variables are imported as character. This is because we want to\nmake a more robust cleaning of the data. Again, just pass the dataframe to \nthe cleaning data and you will have a clean dataset with the types of each variable\ncorrected and some new variables that compact information (e.g. DATE column).\n\n```{r}\neq_get_data() %>% eq_clean_data %>% head\n```\n\nThis function relies on several internal functions, namely:\n\n- numeric_convertible: Check if a data.frame column can be safely converted to\nnumeric type.\n- eq_clean_wrong_parsed_numeric_vectors: Mutate all the columns that can be safely\nconverted to numeric type.\n- eq_clean_dates: Unite YEAR, MONTH and DAY columns into a single \"DATE\" column.\n- eq_clean_coordinates: Remove invalid coordinate rows.\n- eq_clean_location: Removes the country from the LOCATION variable.\n\nAll this functions are implemeted for interal usage.\n\n\n### Visualize a timeline of the dataset\nIt could be useful to visualize the earthquakes across time and other variables\nThis is implemented in a couple of ggplot2's geoms: `geom_timeline` and `geom_timeline_label`.\nThe `geom_timeline` works out of the box with the required aes \"x\". The `geom_timeline_label`\nrequires three aes: \"x\", \"label\" and \"by\". The \"by\" aesthetic is alog with the \"n_max\"\nparam to show only top n_max labels in the by param.\n\n```{r}\ndf <- eq_get_data() %>%\n  eq_clean_data %>%\n  filter(!is.na(EQ_PRIMARY)) %>%\n  filter(year(DATE) > 2000) %>%\n  filter(COUNTRY %in% c(\"CHINA\", \"USA\"))\n\nggplot(df) +\n  aes(\n    x = DATE,\n    y = COUNTRY,\n    size = EQ_PRIMARY,\n    colour = DEATHS,\n    label = LOCATION_NAME,\n    by = EQ_PRIMARY\n  ) +\n  geom_timeline() +\n  geom_timeline_label(n_max = 5) +\n  theme_timeline\n```\n\nThe package also provides the `theme_timeline` wrapper for a clean visualization.\n\n### Visualize the earthquakes in a map\nA leaflet wrapper is implemented to easily visualize the epicenters:\n\n```{r, eval=F}\neq_get_data() %>%\n  eq_clean_data %>%\n  filter(COUNTRY == \"MEXICO\", year(DATE) >= 2000) %>%\n  eq_map(annot_col = \"DATE\")\n\neq_get_data() %>%\n  eq_clean_data %>%\n  filter(COUNTRY == \"MEXICO\", year(DATE) >= 2000) %>%\n  mutate(popup_text = eq_create_label(.)) %>%\n  eq_map(annot_col = \"popup_text\")\n```\n\n\n## References\n\n- National Geophysical Data Center / World Data Service (NGDC/WDS): \n  Significant Earthquake Database.\n  National Geophysical Data Center, NOAA. doi:10.7289/V5TD9V7K\n\n[NOAA]: https://www.ngdc.noaa.gov/nndc/struts/form?t=101650&s=1&d=1\n[tidyverse]: https://github.com/tidyverse/tidyverse\n",
    "created" : 1494084790925.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2042048886",
    "id" : "EF4A9974",
    "lastKnownWriteTime" : 1494084832,
    "last_content_update" : 1494084832145,
    "path" : "~/Desktop/noaamsdr/vignettes/NOAA.Rmd",
    "project_path" : "vignettes/NOAA.Rmd",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}